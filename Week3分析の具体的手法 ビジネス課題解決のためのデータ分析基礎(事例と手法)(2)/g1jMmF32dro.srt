0
00:00:01,869 --> 00:00:06,029
社会人のためのデータサイエンス演習

1
00:00:06,030 --> 00:00:11,389
第3週、課題の補講　Excel分析演習

2
00:00:11,389 --> 00:00:14,909
担当のブレインパッドの橋本武彦です

3
00:00:14,909 --> 00:00:19,569
どうぞよろしくお願いいたします

4
00:00:20,720 --> 00:00:22,409
課題の補講では

5
00:00:22,409 --> 00:00:24,980
各週の課題に取り組むにあたり

6
00:00:24,980 --> 00:00:28,759
各週で説明した分析手法の振り返り

7
00:00:28,759 --> 00:00:31,459
Excelでの実施方法

8
00:00:31,460 --> 00:00:34,040
分析結果の解釈について

9
00:00:34,050 --> 00:00:37,050
デモを交えながら説明します

10
00:00:39,000 --> 00:00:42,100
第3週ではAnalysis

11
00:00:42,100 --> 00:00:46,760
比較と傾向を行う具体的手法として

12
00:00:46,760 --> 00:00:54,980
クロス集計, 散布図, 相関, 時系列について学びました

13
00:00:54,990 --> 00:00:58,300
今回はクロス集計を行なうための

14
00:00:58,300 --> 00:01:02,840
ピボットテーブルや散布図の描き方

15
00:01:02,840 --> 00:01:05,950
相関係数の算出方法

16
00:01:05,950 --> 00:01:12,570
時系列に絡め移動平均の算出方法について説明します

17
00:01:14,160 --> 00:01:17,080
下表のような家族構成と

18
00:01:17,090 --> 00:01:21,470
月別の売上を示すデータがあったとします

19
00:01:21,470 --> 00:01:23,860
クロス集計を行なって

20
00:01:23,860 --> 00:01:29,220
4月と5月でファミリーと単身層の売上に

21
00:01:29,220 --> 00:01:34,080
どのような違いがあるか比較してみましょう

22
00:01:34,080 --> 00:01:38,620
ピボットテーブルのデモでご説明いたします

23
00:01:39,720 --> 00:01:44,420
Excelのピボットテーブルという機能を使って

24
00:01:44,420 --> 00:01:47,260
表側に家族構成

25
00:01:47,260 --> 00:01:52,860
表頭に売上月を表示するクロス集計表を作成します

26
00:01:54,160 --> 00:01:58,080
ツールバーから「挿入」を選択し

27
00:01:58,080 --> 00:02:01,019
集計したいデータを選択して

28
00:02:01,020 --> 00:02:05,200
「ピボットテーブル」を押します

29
00:02:05,200 --> 00:02:10,610
「テーブル範囲」で今回の対象データを選択し

30
00:02:10,610 --> 00:02:13,370
「ピボットテーブルを配置する場所」を選択で

31
00:02:13,370 --> 00:02:19,750
「新規ワークシート」を選択しOKをクリックします

32
00:02:20,540 --> 00:02:25,510
ピボットテーブルのフィールドが表示されます

33
00:02:25,510 --> 00:02:28,030
対象データの各フィールドを

34
00:02:28,030 --> 00:02:31,360
下のボックスにドラッグすることで

35
00:02:31,360 --> 00:02:34,360
様々な集計が可能です

36
00:02:34,960 --> 00:02:40,010
今回は家族構成別に月別の売上を見たいので

37
00:02:40,040 --> 00:02:45,220
左下の「行」に家族構成を追加

38
00:02:45,260 --> 00:02:50,600
右上の「列」に売上月を追加

39
00:02:53,240 --> 00:03:00,660
右下の「値」に売上を追加し合計を設定します

40
00:03:03,220 --> 00:03:06,119
これでクロス集計表ができました

41
00:03:06,140 --> 00:03:11,180
さらにクロス集計の結果の解釈を容易にするために

42
00:03:11,220 --> 00:03:16,300
実数だけでなく、比率も表示してみましょう

43
00:03:16,300 --> 00:03:19,940
続いて売上の値のフィールドから

44
00:03:19,940 --> 00:03:23,160
計算の種類を選択し

45
00:03:23,200 --> 00:03:27,500
割合が表示されるように設定します

46
00:03:27,540 --> 00:03:32,180
右下の「値」にもう一つ売上を追加

47
00:03:33,340 --> 00:03:39,060
右上の列の値を左下の「行」に追加

48
00:03:40,820 --> 00:03:45,660
「合計/売上2」の右の「▼」をクリックし

49
00:03:45,680 --> 00:03:52,500
表示されるリストから「値フィールドの設定」を選択

50
00:03:53,500 --> 00:04:07,060
「名前」を 割合/売上 に変更

51
00:04:07,100 --> 00:04:10,200
「計算の種類」を選択し

52
00:04:16,720 --> 00:04:19,711
行方向の割合を算出する場合

53
00:04:19,779 --> 00:04:22,940
「行集計に対する比率」を選択し

54
00:04:23,000 --> 00:04:26,000
OKをクリックします

55
00:04:27,940 --> 00:04:31,219
これで実数と比率を表示する

56
00:04:31,240 --> 00:04:34,240
クロス集計表が出来上がりました

57
00:04:36,720 --> 00:04:41,639
今回のクロス集計の結果から

58
00:04:41,639 --> 00:04:46,740
全体の売上では5月に低下がみられ

59
00:04:46,740 --> 00:04:52,950
ファミリーと単身の総計では単身の方が売上が低く

60
00:04:53,040 --> 00:04:57,120
ファミリー、単身、共にほぼ同様の割合で

61
00:04:57,120 --> 00:05:02,020
5月の売上が低下していることが分かります

62
00:05:02,080 --> 00:05:04,650
このようにピボットテーブルでは

63
00:05:04,720 --> 00:05:07,360
値フィールドの設定を行うことで

64
00:05:07,360 --> 00:05:09,469
比率も表示できるなど

65
00:05:09,469 --> 00:05:12,920
任意の計算を行うことが可能です

66
00:05:12,920 --> 00:05:16,360
また、今回は用いませんでしたが

67
00:05:16,360 --> 00:05:19,400
ピボットテーブルの左上のフィルタは

68
00:05:19,400 --> 00:05:22,020
例えば家族構成のうち

69
00:05:22,020 --> 00:05:24,800
単身世帯だけを表示したい時などに

70
00:05:24,800 --> 00:05:27,780
用いることが可能です

71
00:05:27,780 --> 00:05:30,380
ピボットテーブルを用いることで

72
00:05:30,400 --> 00:05:34,420
クロス集計をはじめとした基本的な分析を

73
00:05:34,420 --> 00:05:37,031
概ね押さえることが可能です

74
00:05:37,040 --> 00:05:39,140
大変便利な機能ですので

75
00:05:39,140 --> 00:05:42,760
是非、集計の際は活用しましょう

76
00:05:47,160 --> 00:05:52,380
次は散布図についてやり方を説明します

77
00:05:52,380 --> 00:05:55,100
下表のような年次別の

78
00:05:55,100 --> 00:06:00,520
作付面積と収穫量を示すデータがあります

79
00:06:00,520 --> 00:06:03,740
散布図を実際に描画して

80
00:06:03,750 --> 00:06:06,680
関係性を見てみましょう

81
00:06:07,920 --> 00:06:13,920
まず散布図を描画したい対象のデータを選択し

82
00:06:13,920 --> 00:06:19,620
「挿入」から「グラフ」、「散布図」を選択します

83
00:06:21,580 --> 00:06:24,180
散布図が表示されました

84
00:06:24,180 --> 00:06:28,980
見やすいように軸を調整します

85
00:06:47,420 --> 00:06:50,560
散布図が表示されました

86
00:06:50,560 --> 00:06:54,181
散布図から右肩上がりの形状があり

87
00:06:54,181 --> 00:06:56,919
正の相関があること

88
00:06:56,920 --> 00:06:58,400
加えて

89
00:06:58,400 --> 00:07:04,680
右下に外れ値があることの２点が分かります

90
00:07:08,520 --> 00:07:12,330
次に先ほどの正の相関がみられた

91
00:07:12,330 --> 00:07:15,380
作付面積と収穫量の間に

92
00:07:15,380 --> 00:07:18,080
実際にどの程度の相関があるか

93
00:07:18,080 --> 00:07:22,020
相関係数を算出してみましょう

94
00:07:22,020 --> 00:07:27,920
デモを元に相関係数の算出方法について説明します

95
00:07:29,060 --> 00:07:32,380
まずツールバーから「データ」

96
00:07:32,380 --> 00:07:35,149
「データ分析」をクリックし

97
00:07:37,740 --> 00:07:42,500
「相関」を選択してOKを押します

98
00:07:42,500 --> 00:07:49,440
「入力範囲」に今回の対象データを選択し

99
00:07:50,540 --> 00:07:54,740
「先頭行をラベルとして使用」にチェックをいれて入れて

100
00:07:54,740 --> 00:07:57,080
OKをクリックします

101
00:08:05,980 --> 00:08:12,940
作付面積と収穫量の相関係数が算出されました

102
00:08:15,400 --> 00:08:20,100
今回、作付面積と収穫量の間には

103
00:08:20,100 --> 00:08:24,340
相関係数ｒ=0.65と

104
00:08:24,340 --> 00:08:29,200
中程度の正の相関があることが分かりました

105
00:08:29,200 --> 00:08:31,220
実際の分析では

106
00:08:31,220 --> 00:08:36,520
複数の変数の関係を見ることの方が多いと思います

107
00:08:36,520 --> 00:08:40,940
分析ツールのアドインで3つ以上の変数を選択し

108
00:08:40,940 --> 00:08:45,120
一度で相関を算出することが可能です

109
00:08:45,120 --> 00:08:50,640
関数と合わせてうまく活用してください

110
00:08:50,640 --> 00:08:55,320
次に移動平均のやり方を説明します

111
00:08:55,320 --> 00:08:57,860
下の図表は月別に

112
00:08:57,860 --> 00:09:02,160
自動車教習料の支出額を示したものです

113
00:09:02,160 --> 00:09:03,950
時系列データは

114
00:09:03,960 --> 00:09:09,780
「傾向変動・循環変動」と「季節変動」,「不規則変動」に

115
00:09:09,780 --> 00:09:12,400
分解できることを学びましたが

116
00:09:12,400 --> 00:09:15,560
12ヶ月移動平均値を算出して

117
00:09:15,560 --> 00:09:20,080
季節変動を除いたグラフを作成してみましょう

118
00:09:20,720 --> 00:09:27,640
ここからはデモを用いて移動平均を算出します

119
00:09:27,640 --> 00:09:29,780
ツールバーの「データ」から

120
00:09:29,780 --> 00:09:31,820
「データ分析」をクリックし

121
00:09:31,820 --> 00:09:37,720
「移動平均」を選択してOKをクリックします

122
00:09:37,720 --> 00:09:44,340
「入力範囲」に今回の対象データを選択し

123
00:09:45,360 --> 00:09:49,780
「区間」に12を入力し

124
00:09:49,780 --> 00:09:56,460
「出力先」にC列を選択して

125
00:09:56,460 --> 00:09:59,600
OKをクリックします

126
00:10:00,940 --> 00:10:03,940
12ヶ月後方移動平均ですので

127
00:10:03,940 --> 00:10:07,060
頭の12ヶ月は計算されずに

128
00:10:07,060 --> 00:10:10,500
12ヶ月目から移動平均の値が

129
00:10:10,500 --> 00:10:13,860
計算されて表示されています

130
00:10:19,600 --> 00:10:24,500
12ヶ月の移動平均が算出されました

131
00:10:24,500 --> 00:10:27,560
グラフから支出金額が

132
00:10:27,560 --> 00:10:31,580
減少傾向にあることがよく分かります

133
00:10:31,580 --> 00:10:35,960
このように季節変動の影響を除外することで

134
00:10:35,960 --> 00:10:40,660
より時系列の傾向の解釈がやりやすくなります

135
00:10:43,920 --> 00:10:46,280
ちなみに分析ツールでは

136
00:10:46,280 --> 00:10:48,860
後方移動平均のみが算出可能です

137
00:10:50,120 --> 00:10:52,180
中心化移動平均など

138
00:10:52,180 --> 00:10:55,180
他の移動平均を用いたい場合は

139
00:10:55,180 --> 00:10:58,680
関数を用いて算出する必要がありますので

140
00:10:58,680 --> 00:10:59,820
ご注意ください

141
00:11:01,300 --> 00:11:04,060
第3週の補講は以上です

142
00:11:04,060 --> 00:11:06,760
皆さんお疲れさまでした

