0
00:00:01,369 --> 00:00:04,410
社会人のためのデータサイエンス演習

1
00:00:04,410 --> 00:00:08,270
第2回モデル評価と予実評価です

2
00:00:10,260 --> 00:00:15,499
前回の第1回では回帰分析を例として使い

3
00:00:15,499 --> 00:00:18,770
データを準備してモデルを構築するまでの

4
00:00:18,770 --> 00:00:21,770
代表的な流れを説明してきました

5
00:00:22,289 --> 00:00:24,749
今回の第2回では

6
00:00:24,749 --> 00:00:29,129
モデルの評価に関して説明したいと思います

7
00:00:29,129 --> 00:00:33,760
またモデルを構築する際に注意しなくてはならない

8
00:00:33,760 --> 00:00:35,660
いくつかのポイントに関しても

9
00:00:35,660 --> 00:00:38,660
取り上げたいと思います

10
00:00:40,160 --> 00:00:43,340
ではまずモデルの評価に関して

11
00:00:43,340 --> 00:00:45,660
お話ししたいと思います

12
00:00:45,670 --> 00:00:47,810
モデル評価のプロセスでは

13
00:00:47,810 --> 00:00:51,270
いわゆるモデルの良さという観点から

14
00:00:51,270 --> 00:00:53,760
例えばR²(アールスクエア)値によって

15
00:00:53,770 --> 00:00:56,770
データへの当てはまりの良さを確認したり

16
00:00:56,770 --> 00:01:02,020
またモデルの予測精度といったものを確認します

17
00:01:02,020 --> 00:01:05,030
もちろんビジネス的な観点から

18
00:01:05,030 --> 00:01:07,799
妥当性のあるモデルになっていることの

19
00:01:07,799 --> 00:01:11,539
確認を行うことも非常に重要です

20
00:01:12,500 --> 00:01:16,120
例えば線形回帰モデルであれば

21
00:01:16,130 --> 00:01:18,930
説明変数の係数の符号が

22
00:01:18,930 --> 00:01:22,570
ビジネス的な観点で妥当であるかなどの

23
00:01:22,570 --> 00:01:25,570
検証を行わなくてはなりません

24
00:01:26,400 --> 00:01:28,940
その結果必要であれば

25
00:01:28,940 --> 00:01:32,670
用いるデータや変数の見直しなどを行い

26
00:01:32,670 --> 00:01:37,450
モデルを再構築し再び評価することになります

27
00:01:39,140 --> 00:01:42,740
次のスライドではモデル評価のプロセスで

28
00:01:42,740 --> 00:01:45,280
注意しなくてはならないポイントを

29
00:01:45,280 --> 00:01:48,260
いくつか説明したいと思います

30
00:01:50,060 --> 00:01:54,540
モデルの精度を悪化させる1つの原因に

31
00:01:54,540 --> 00:01:57,410
外れ値データの存在があります

32
00:01:57,410 --> 00:02:02,750
このスライドの図のようにデータの分布の傾向から

33
00:02:02,750 --> 00:02:07,890
大きく異なる値を持つデータを外れ値と呼びます

34
00:02:07,890 --> 00:02:11,529
この図の場合赤で示したデータは

35
00:02:11,529 --> 00:02:13,849
青でプロットされたものとは

36
00:02:13,849 --> 00:02:16,880
大きく異なる場所にプロットされており

37
00:02:16,880 --> 00:02:20,340
外れ値と呼ばれます

38
00:02:20,349 --> 00:02:24,689
実際のデータ分析では収集されたデータに

39
00:02:24,689 --> 00:02:27,389
このような外れ値が含まれていることが

40
00:02:27,389 --> 00:02:29,629
しばしば起こります

41
00:02:29,629 --> 00:02:31,579
このような場合には

42
00:02:31,579 --> 00:02:34,360
外れ値をデータから除外するなど

43
00:02:34,360 --> 00:02:37,880
適切に処理をする必要があります

44
00:02:39,089 --> 00:02:43,589
2つ目のポイントは欠損値の扱いです

45
00:02:43,589 --> 00:02:47,279
実際のビジネスで使われているデータベースには

46
00:02:47,279 --> 00:02:50,119
この表のように本来

47
00:02:50,119 --> 00:02:53,799
何かしらの数値が入っていなくてはならない箇所に

48
00:02:53,800 --> 00:02:57,180
空白であったり意味のない文字などが

49
00:02:57,180 --> 00:03:00,539
入力されている場合がよくあります

50
00:03:00,539 --> 00:03:04,319
空白の箇所は欠損値と呼ばれ

51
00:03:04,320 --> 00:03:06,859
適切に前処理をしないと

52
00:03:06,859 --> 00:03:09,699
ツールによっては処理ができなかったり

53
00:03:09,700 --> 00:03:12,880
あるいは処理が行われたとしても

54
00:03:12,890 --> 00:03:17,300
正しい結果が得られない場合もあります

55
00:03:17,300 --> 00:03:20,400
欠損値が少数の場合は

56
00:03:20,409 --> 00:03:24,559
そのようなレコードを削除すればよいのですが

57
00:03:24,559 --> 00:03:27,659
多くの箇所に欠損が生じていて

58
00:03:27,659 --> 00:03:30,639
欠損値のあるレコードを除外すると

59
00:03:30,639 --> 00:03:33,559
データ数が大きく減少してしまう

60
00:03:33,559 --> 00:03:36,119
こういった場合には例えば

61
00:03:36,120 --> 00:03:40,920
平均値や最頻値などで補完をします

62
00:03:40,920 --> 00:03:45,300
ただなぜ欠損が生じているかを

63
00:03:45,300 --> 00:03:48,480
考えてみることが最も重要で

64
00:03:48,489 --> 00:03:51,069
ツールが動かないからといって

65
00:03:51,069 --> 00:03:55,120
安易に平均値を使い補完などをすると

66
00:03:55,120 --> 00:03:58,900
分析結果が妥当性を持たないものになる場合もあり

67
00:03:58,900 --> 00:04:01,900
十分な検討が必要です

68
00:04:04,600 --> 00:04:07,920
その他精度低下を招くものに

69
00:04:07,929 --> 00:04:12,320
オーバーフィッティングがよく知られています

70
00:04:12,329 --> 00:04:14,920
例えばこの図のように

71
00:04:14,920 --> 00:04:20,780
非常に複雑な非線形性の高いモデルを用いた場合に

72
00:04:20,779 --> 00:04:25,620
データが元々持っている誤差や不確実性といった

73
00:04:25,620 --> 00:04:29,620
本来説明ができない部分までフィットするような

74
00:04:29,620 --> 00:04:31,660
いわば誤ったモデルが

75
00:04:31,660 --> 00:04:34,800
構築されてしまう場合があります

76
00:04:34,809 --> 00:04:38,469
結果として非常に予測精度の低いモデルと

77
00:04:38,469 --> 00:04:41,900
なってしまう場合があるわけです

78
00:04:41,900 --> 00:04:45,520
一般的には線形モデルのような

79
00:04:45,520 --> 00:04:50,300
より単純なモデルや説明変数を少なくすることで

80
00:04:50,300 --> 00:04:55,900
オーバーフィッティングを防ぐことが行われています

81
00:04:59,980 --> 00:05:02,820
最後に外れ値の影響を

82
00:05:02,830 --> 00:05:06,860
具体的な数値例を使い見てみます

83
00:05:06,860 --> 00:05:10,800
左の表は両親の平均身長と

84
00:05:10,800 --> 00:05:13,450
子どもの身長のデータを示しており

85
00:05:13,450 --> 00:05:18,320
その散布図が右に示されています

86
00:05:18,320 --> 00:05:20,520
散布図を見ていただくと

87
00:05:20,520 --> 00:05:22,720
よくお分かりになると思いますが

88
00:05:22,720 --> 00:05:27,900
この例では両親の平均身長と子どもの身長とは

89
00:05:27,900 --> 00:05:32,440
ほぼ線形な関係にあることが読み取れます

90
00:05:32,440 --> 00:05:35,640
また左上に1点

91
00:05:35,650 --> 00:05:38,520
他とは傾向の違うデータが

92
00:05:38,520 --> 00:05:41,240
プロットされていることが分かります

93
00:05:43,729 --> 00:05:47,700
仮に観測データすべてを使い

94
00:05:47,700 --> 00:05:49,910
回帰モデルを構築した場合

95
00:05:49,910 --> 00:05:52,490
この図のような直線となり

96
00:05:52,490 --> 00:05:56,879
R²(アールスクエア)値は約0.3と

97
00:05:56,879 --> 00:06:00,259
全体的に当てはまりがさほど良くない

98
00:06:00,260 --> 00:06:03,600
モデルができてしまいます

99
00:06:05,060 --> 00:06:11,020
一方でこの左上のデータを外れ値と考え除外し

100
00:06:11,020 --> 00:06:14,960
またこの図に示すような補完を実施し

101
00:06:14,960 --> 00:06:19,659
回帰モデルを構築したものが右のグラフとなります

102
00:06:19,659 --> 00:06:21,599
右のグラフの方が

103
00:06:21,599 --> 00:06:25,999
点の分布に重なるような回帰直線が得られており

104
00:06:26,009 --> 00:06:31,060
実際データへの当てはまりを示す指標であるR²(アールスクエア)値も

105
00:06:31,060 --> 00:06:34,060
およそ0.8を超えており

106
00:06:34,069 --> 00:06:39,060
左の図と比べ大幅に予測精度が向上していることが

107
00:06:39,060 --> 00:06:41,640
おわかりいただけると思います

108
00:06:43,840 --> 00:06:49,160
次回は第3回の分析結果の報告を扱います

